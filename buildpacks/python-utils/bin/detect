#!/usr/bin/env bash
set -euo pipefail

platform_dir=$1
build_plan=$2

buildpack_root="$(cd "$(dirname "${BASH_SOURCE[0]}")/.." && pwd)"


# Skip if already installed, no python version is specified, or results were cached
if [ -z "${BP_CPYTHON_VERSION}" ] && [ "${DEVCONTAINER_PYTHON_UTILS}" != "false" ]; then
    return 100
fi

echo "Adding development dependencies. Using custom Python version: ${BP_CPYTHON_VERSION}"
cat "${buildpack_root}/assets/plan.toml" >> "${build_plan}"

exit 0
